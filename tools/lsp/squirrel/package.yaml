name: ligo-squirrel

dependencies:
  - base
  - bytestring
  - containers
  - data-default
  - duplo
  - exceptions
  - fastsum
  - filepath
  - ghc-prim
  - interpolate
  - mtl
  - pretty
  - text
  - transformers
  - tree-sitter

default-extensions:
  - AllowAmbiguousTypes
  - ApplicativeDo
  - BangPatterns
  - BlockArguments
  - ConstraintKinds
  - DataKinds
  - DeriveAnyClass
  - DeriveFoldable
  - DeriveFunctor
  - DeriveTraversable
  - DerivingStrategies
  - DerivingVia
  - DuplicateRecordFields
  - FlexibleContexts
  - FlexibleInstances
  - FunctionalDependencies
  - GADTs
  - GeneralisedNewtypeDeriving
  - LambdaCase
  - MagicHash
  - MultiParamTypeClasses
  - MultiWayIf
  - NamedFieldPuns
  - OverloadedStrings
  - QuasiQuotes
  - ScopedTypeVariables
  - StandaloneDeriving
  - TemplateHaskell
  - TypeApplications
  - TypeFamilies
  - TypeOperators
  - UndecidableInstances
  - ViewPatterns

ghc-options: -freverse-errors -Wall

library:
  source-dirs:
    - src/

  include-dirs:
    - vendor/pascaligo
    - vendor/reasonligo
    - vendor/camligo

  c-sources:
    - vendor/pascaligo/parser.c
    - vendor/reasonligo/parser.c
    - vendor/camligo/parser.c

  dependencies:
    - haskell-lsp-types
    - aeson
    - process
    - lens
    - lens-aeson
    - bytestring
    - unordered-containers

executables:
  squirrel:
    dependencies:
      - haskell-lsp
      - hslogger
      - interpolate
      - lens
      - lens-aeson
      - ligo-squirrel
      - directory
      - unix
      - stm

    main: Main.hs

    source-dirs:
      - app/

    ghc-options:
      - -threaded

  vet:
    main: vet.hs

    source-dirs:
      - app/

    dependencies:
      - ligo-squirrel
      - optparse-applicative
      - with-utf8

tests:
  squirrel-test:
    main: Driver.hs

    source-dirs:
      - test/

    dependencies:
      - HUnit
      - directory
      - filepath
      - hspec-expectations
      - ligo-squirrel
      - tasty
      - tasty-discover
      - tasty-hspec
      - tasty-hunit
